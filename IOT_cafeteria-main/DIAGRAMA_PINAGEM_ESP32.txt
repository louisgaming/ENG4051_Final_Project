================================================================================
              DIAGRAMA DE PINAGEM - ESP32-WROOM-32
            Sistema de DispensaÃ§Ã£o de LÃ­quidos (CafÃ© e Ãgua)
================================================================================

                           ESP32-WROOM-32
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
        [RFID RST]  â”‚ GPIO 17                 â”‚
        [EPD RST]   â”‚ GPIO 15                 â”‚
        [EPD DC]    â”‚ GPIO 14                 â”‚
        [CONTATO]   â”‚ GPIO 13                 â”‚
        [EPD CS]    â”‚ GPIO 10                 â”‚
                    â”‚                         â”‚
        [SOL_PIN2]  â”‚ GPIO 4                  â”‚
                    â”‚                         â”‚
        [EPD BUSY]  â”‚ GPIO 16                 â”‚
                    â”‚                         â”‚
        [ECHO2]     â”‚ GPIO 18   (SPI SCK)     â”‚ â† Compartilhado
        [TRIG2]     â”‚ GPIO 19   (SPI MISO)    â”‚ â† Compartilhado
        [ECHO1]     â”‚ GPIO 21                 â”‚
        [TRIG1]     â”‚ GPIO 22                 â”‚
                    â”‚ GPIO 23   (SPI MOSI)    â”‚
                    â”‚                         â”‚
        [BTN_LEFT]  â”‚ GPIO 25                 â”‚ âœ… Teste1.cpp
        [RELE2]     â”‚ GPIO 26                 â”‚ âœ… Teste1.cpp
        [SOL_PIN1]  â”‚ GPIO 27                 â”‚
                    â”‚                         â”‚
        [BTN_RIGHT] â”‚ GPIO 32                 â”‚ âœ… Teste1.cpp
        [RELE1]     â”‚ GPIO 33                 â”‚ âœ… Teste1.cpp
                    â”‚                         â”‚
        [RFID CS]   â”‚ GPIO 46                 â”‚
                    â”‚                         â”‚
                    â”‚ GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
                    â”‚ 3.3V â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
                    â”‚ 5V â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
                    â”‚                         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
                          LEGENDA DE CONEXÃ•ES
================================================================================

ğŸ”µ INTERFACE DE USUÃRIO
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 25  â†’ BotÃ£o LEFT   (Seleciona CafÃ© / Tamanho Pequeno)
  GPIO 32  â†’ BotÃ£o RIGHT  (Seleciona Ãgua / Tamanho MÃ©dio)

ğŸ”´ CONTROLE DE LÃQUIDOS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 33  â†’ RelÃ© 1  (VÃ¡lvula CafÃ©)
  GPIO 26  â†’ RelÃ© 2  (VÃ¡lvula Ãgua)

ğŸŸ¢ SISTEMA DE TRAVAMENTO
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 27  â†’ Solenoide PIN1 (Fase 1)
  GPIO 4   â†’ Solenoide PIN2 (Fase 2)
  GPIO 13  â†’ Sensor Contato (Porta aberta/fechada)

ğŸŸ¡ SENSORES DE ESTOQUE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 22  â†’ UltrassÃ´nico 1 TRIGGER (CafÃ©)
  GPIO 21  â†’ UltrassÃ´nico 1 ECHO (CafÃ©)
  GPIO 19  â†’ UltrassÃ´nico 2 TRIGGER (Ãgua)
  GPIO 18  â†’ UltrassÃ´nico 2 ECHO (Ãgua)

ğŸŸ£ RFID (RC522)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 46  â†’ CS/SDA
  GPIO 17  â†’ RST
  GPIO 18  â†’ SCK  (SPI compartilhado)
  GPIO 19  â†’ MISO (SPI compartilhado)
  GPIO 23  â†’ MOSI (SPI compartilhado)

ğŸŸ  E-PAPER DISPLAY (Waveshare 2.9")
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  GPIO 10  â†’ CS
  GPIO 14  â†’ DC
  GPIO 15  â†’ RST
  GPIO 16  â†’ BUSY
  GPIO 18  â†’ SCK  (SPI compartilhado)
  GPIO 23  â†’ MOSI (SPI compartilhado)

================================================================================
                       ESQUEMA DE CONEXÃƒO DETALHADO
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BOTÃ•ES       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  BotÃ£o LEFT (GPIO 25):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
  â”‚  BTN  â”œâ”€â”€â†’ GPIO 25 (INPUT_PULLUP)
  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â†’ GND

  BotÃ£o RIGHT (GPIO 32):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
  â”‚  BTN  â”œâ”€â”€â†’ GPIO 32 (INPUT_PULLUP)
  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â†’ GND

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RELÃ‰S        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  MÃ³dulo RelÃ© 2 Canais:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ IN1 â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 33 (CafÃ©)
  â”‚ IN2 â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 26 (Ãgua)
  â”‚ VCC â†â”€â”€â”€â”€â”€â”€â”€â”€ 5V (fonte externa)
  â”‚ GND â†â”€â”€â”€â”€â”€â”€â”€â”€ GND (comum)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“  â†“
  [VÃ¡lvula  VÃ¡lvula]
   CafÃ©     Ãgua

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SOLENOIDE    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Driver H-Bridge:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ IN1 â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 27
  â”‚ IN2 â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 4
  â”‚ VCC â†â”€â”€â”€â”€â”€â”€â”€â”€ 12V (fonte externa)
  â”‚ GND â†â”€â”€â”€â”€â”€â”€â”€â”€ GND (comum)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
  [Solenoide]
   Travamento

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ULTRASSÃ”NICOS    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  HC-SR04 #1 (CafÃ©):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ VCC â†â”€â”€â”€â”€â”€â”€â”€â”€ 5V
  â”‚ TRIG â†â”€â”€â”€â”€â”€â”€â”€ GPIO 22
  â”‚           â”Œâ”€ GPIO 21 (3.3V via divisor!)
  â”‚ ECHO â”€â”€â”€â”€â”€â”¤
  â”‚           â””â”€ [Divisor: 1kÎ© + 2kÎ©]
  â”‚ GND â†â”€â”€â”€â”€â”€â”€â”€â”€ GND
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  HC-SR04 #2 (Ãgua):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ VCC â†â”€â”€â”€â”€â”€â”€â”€â”€ 5V
  â”‚ TRIG â†â”€â”€â”€â”€â”€â”€â”€ GPIO 19
  â”‚           â”Œâ”€ GPIO 18 (3.3V via divisor!)
  â”‚ ECHO â”€â”€â”€â”€â”€â”¤
  â”‚           â””â”€ [Divisor: 1kÎ© + 2kÎ©]
  â”‚ GND â†â”€â”€â”€â”€â”€â”€â”€â”€ GND
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ DIVISOR DE TENSÃƒO OBRIGATÃ“RIO:

  5V â”€â”€[1kÎ©]â”€â”€â”¬â”€â”€[2kÎ©]â”€â”€ GND
              â”‚
              â””â”€â”€â”€â†’ ESP32 (GPIO ECHO)
              (3.3V)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RFID RC522   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ SDA â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 46 (CS)
  â”‚ SCK â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 18 (SPI)
  â”‚ MOSI â†â”€â”€â”€â”€â”€â”€â”€ GPIO 23 (SPI)
  â”‚ MISO â†â”€â”€â”€â”€â”€â”€â”€ GPIO 19 (SPI)
  â”‚ IRQ (NC)
  â”‚ GND â†â”€â”€â”€â”€â”€â”€â”€â”€ GND
  â”‚ RST â†â”€â”€â”€â”€â”€â”€â”€â”€ GPIO 17
  â”‚ 3.3V â†â”€â”€â”€â”€â”€â”€â”€ 3.3V
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ E-PAPER      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ BUSY â”€â”€â”€â”€â†’ GPIO 16 (INPUT)
  â”‚ RST â†â”€â”€â”€â”€â”€ GPIO 15
  â”‚ DC â†â”€â”€â”€â”€â”€â”€ GPIO 14
  â”‚ CS â†â”€â”€â”€â”€â”€â”€ GPIO 10
  â”‚ CLK â†â”€â”€â”€â”€â”€ GPIO 18 (SPI)
  â”‚ DIN â†â”€â”€â”€â”€â”€ GPIO 23 (SPI)
  â”‚ GND â†â”€â”€â”€â”€â”€ GND
  â”‚ VCC â†â”€â”€â”€â”€â”€ 3.3V
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
                           LISTA DE MATERIAIS
================================================================================

Quantidade | Item                                  | ObservaÃ§Ã£o
-----------|---------------------------------------|---------------------------
    1      | ESP32-WROOM-32                        | Microcontrolador
    1      | E-Paper 2.9" Waveshare                | Display
    1      | RFID RC522                            | Leitor de cartÃµes
    2      | BotÃµes tÃ¡cteis (push button)          | Normalmente abertos
    1      | MÃ³dulo relÃ© 2 canais 5V               | Para vÃ¡lvulas
    2      | VÃ¡lvulas solenoides 12V               | Para lÃ­quidos
    1      | Solenoide de travamento 12V           | Tranca da porta
    1      | Driver H-Bridge (ex: L298N mini)      | Para solenoide
    1      | Reed switch ou microswitch            | Sensor de porta
    2      | HC-SR04 (ultrassÃ´nico)                | Sensores de nÃ­vel
    4      | Resistor 1kÎ©                          | Divisor de tensÃ£o
    4      | Resistor 2kÎ©                          | Divisor de tensÃ£o
    1      | Fonte 5V 2A                           | Para ESP32 e relÃ©s
    1      | Fonte 12V 2A                          | Para solenoide/vÃ¡lvulas
    1      | Protoboard ou PCB                     | Montagem
    X      | Jumpers / fios                        | ConexÃµes

================================================================================
                         CHECKLIST DE SEGURANÃ‡A
================================================================================

  â˜ Verificar todas as conexÃµes GND comuns
  â˜ Divisores de tensÃ£o instalados nos HC-SR04
  â˜ RelÃ©s alimentados por fonte externa (nÃ£o ESP32)
  â˜ Solenoide com driver adequado (nÃ£o direto no GPIO)
  â˜ BotÃµes com pull-up interno ativado no cÃ³digo
  â˜ TensÃµes corretas: 3.3V para ESP32, 5V para perifÃ©ricos, 12V para atuadores
  â˜ NÃ£o usar GPIOs 6-11 (flash interna)
  â˜ NÃ£o usar GPIO 0, 2, 12, 15 para entrada crÃ­tica (boot strapping)
  â˜ Testar cada mÃ³dulo individualmente antes da integraÃ§Ã£o

================================================================================
                    CÃ“DIGOS DE TESTE INDIVIDUAIS
================================================================================

--- Teste BotÃµes ---
#define BTN_L 25
#define BTN_R 32
void setup() {
  Serial.begin(115200);
  pinMode(BTN_L, INPUT_PULLUP);
  pinMode(BTN_R, INPUT_PULLUP);
}
void loop() {
  if (!digitalRead(BTN_L)) Serial.println("LEFT!");
  if (!digitalRead(BTN_R)) Serial.println("RIGHT!");
  delay(100);
}

--- Teste RelÃ©s ---
#define REL1 33
#define REL2 26
void setup() {
  pinMode(REL1, OUTPUT);
  pinMode(REL2, OUTPUT);
}
void loop() {
  digitalWrite(REL1, HIGH); delay(3000); digitalWrite(REL1, LOW);
  delay(1000);
  digitalWrite(REL2, HIGH); delay(5000); digitalWrite(REL2, LOW);
  delay(1000);
}

--- Teste UltrassÃ´nicos ---
#include <Ultrasonic.h>
Ultrasonic ultra(22, 21); // trig, echo
void setup() {
  Serial.begin(115200);
}
void loop() {
  Serial.println(ultra.read());
  delay(500);
}

================================================================================
                           FIM DO DIAGRAMA
================================================================================
Arquivo: DIAGRAMA_PINAGEM_ESP32.txt
Projeto: Sistema de DispensaÃ§Ã£o de LÃ­quidos - CafÃ© e Ãgua
VersÃ£o: 1.0 - Final
Data: 2025
================================================================================
